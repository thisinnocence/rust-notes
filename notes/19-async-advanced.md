# 19 - Async 进阶：Pin / 取消 / 背压

本章目标：从“会写 async”到“能稳定运行 async 系统”。

## 1. Pin/Unpin 是什么

- 某些 `Future` 在轮询过程中不能被移动。
- `Pin` 用来表达“内存位置固定”约束。
- 多数业务代码由编译器和库处理，你需要理解边界而非到处手写 `Pin`。

## 2. 取消语义

- `Future` 被丢弃即取消。
- 取消不是异常，通常是控制流的一部分。
- 需要确保取消后资源能正确释放与回滚。

## 3. 背压（Backpressure）

- 当生产速度 > 消费速度，系统必须限流或排队。
- 无背压的 async 系统会在高峰期内存暴涨或尾延迟失控。

## 4. 进阶实践

- 统一超时策略（请求级、阶段级）。
- 对外部依赖使用隔离舱（bulkhead）与并发上限。
- 对关键路径做 tracing，观测排队与等待时间。

## 5. 一句话总结

- async 进阶的核心不是语法，而是“生命周期管理 + 流量控制 + 可观测性”。
